{"path":"RA/Lecture/LectureNotes2024.pdf","text":"Real Analysis: Differentiation Yuzhao Wang Contents 1 Basic materials 2 1.1 Set Theory Notation . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.2 Intervals and bounded sets . . . . . . . . . . . . . . . . . . . . . . 3 1.3 Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 1.4 Euclidean distance on the real line . . . . . . . . . . . . . . . . . 4 1.5 Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 1.6 Elementary functions and domain convention . . . . . . . . . . . 5 2 Limits of functions 8 2.1 Limit at a point . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 2.2 One-sided limits and limits as x tends to ∞ . . . . . . . . . . . . 12 2.3 Non-existence of a limit . . . . . . . . . . . . . . . . . . . . . . . 13 2.4 Properties of limits . . . . . . . . . . . . . . . . . . . . . . . . . . 14 3 Continuous functions 19 3.1 Definition of Continuity . . . . . . . . . . . . . . . . . . . . . . . 19 3.2 Continuity of Elementary functions . . . . . . . . . . . . . . . . . 21 3.3 Properties of continuous functions on [a, b] . . . . . . . . . . . . . 23 4 Differentiation 24 4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 4.1.1 Tangent lines . . . . . . . . . . . . . . . . . . . . . . . . . 24 4.1.2 Velocities . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 4.2 Definition and basic properties . . . . . . . . . . . . . . . . . . . 25 4.3 Differentiation rules . . . . . . . . . . . . . . . . . . . . . . . . . 27 4.4 Derivatives of Inverse Functions . . . . . . . . . . . . . . . . . . . 33 4.5 Implicit differentiation and logarithmic differentiation . . . . . . 35 5 Applications of differentiation 38 5.1 Rolle’s theorem and mean value theorems . . . . . . . . . . . . . 38 5.2 L’Hospital’s rule . . . . . . . . . . . . . . . . . . . . . . . . . . . 39 5.3 Higher derivatives and Taylor’s theorem . . . . . . . . . . . . . . 42 5.4 Maximum and Minimum values . . . . . . . . . . . . . . . . . . . 43 5.5 Curve Sketching . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 5.5.1 Asymptotes . . . . . . . . . . . . . . . . . . . . . . . . . . 47 5.5.2 Concavity . . . . . . . . . . . . . . . . . . . . . . . . . . . 49 1 1 Basic materials We begin by recalling some notations. Informally speaking, a set is a (finite or infinite) collection of objects, called elements of the set. We denote by R the set of real numbers, Q the set of rational numbers, Z the set of integers, and N = {1, 2, . . .} the set of natural numbers. We use the symbol ∅ to denote the empty set, that is, the set that has no elements. 1.1 Set Theory Notation • If an element a belongs to a set A, we write a ∈ A; and if not we write a /∈ A. • If A is a subset of B (perhaps equal to B), we write A ⊆ B (or B ⊇ A). • Let A and B be two subsets of a set X. Then, A = B iff 1 (A ⊆ B and B ⊆ A). • Let A and B be two sets such that A, B ⊆ X. (1) The union of A and B, A ∪ B, is the set defined by A ∪ B = {x ∈ X : x ∈ A or x ∈ B}. (2) The intersection of A and B, A ∩ B, is the set defined by A ∩ B = {x ∈ X : x ∈ A and x ∈ B}. If A ∩ B = ∅, then A and B have no points in common and A and B are said to be disjoint. • Let A be a subset of a set X. Then, the complement of A in X, Ac (also X − A or X\\A) is the set Ac = {x ∈ X such that x /∈ A}. • Let X, Y ⊂ R. The Cartesian product of X and Y 2 is denoted by X × Y := {(x, y) : x ∈ X and y ∈ Y }. • The following identities are known as the De Morgan’s Laws, (A ∪ B)c = Ac ∩ Bc and (A ∩ B)c = Ac ∪ Bc. 1Iff means “if and only if\" (and can also be denoted as ⇐⇒ ). 2The Cartesian product is defined for more than 2 sets similarly. 2 1.2 Intervals and bounded sets An interval is a subset of R in one of the following forms, where a, b ∈ R and a < b. (a, b) := {x ∈ R : a < x < b} (this is called an open interval) (a, b] := {x ∈ R : a < x ≤ b} [a, b) := {x ∈ R : a ≤ x < b} [a, b] := {x ∈ R : a ≤ x ≤ b} (this is called a closed interval) (a, ∞) := {x ∈ R : x > a} [a, ∞) := {x ∈ R : x ≥ a} (−∞, b) := {x ∈ R : x < b} (−∞, b] := {x ∈ R : x ≤ b} (−∞, ∞) := R The intervals (0, ∞) and (−∞, 0) are denoted by R+ and R− respectively.3 It will be useful to have a notion of a bounded set of real numbers. This is provided in Definition 1.1. A subset Y ⊆ R is a bounded set if there exists K ∈ R such that |x| ≤ K for all x ∈ Y. Note that if −∞ < a < b < ∞ then the intervals (a, b) and [a, b] are bounded sets. 1.3 Functions Suppose that X, Y ⊆ R. A real function f : X → Y is a rule which assigns to every real number x ∈ X a unique real number y ∈ Y . If the number y ∈ Y corresponds to the number x ∈ X, then we write y = f (x). • The domain of f , Dom(f ), is the set X. The codomain of f is the set Y . • The image or the range of f is the subset of Y given by f (X) = {f (x) : x ∈ X}. We will also use the notation Im(f ) for f (X). • The graph of f is the set of points in R2 defined by {(x, f (x)) ∈ R2 : x ∈ X}. Example 1.2. The first two items contain familiar real functions. The last item shows that real sequences can be considered as functions with domain N and range R. 3For intervals, [ and ] mean endpoints are included, while ( and ) mean endpoints are excluded. 3 1. f : R → R given by f (x) = x2 for all x ∈ R. 2. f : [0, ∞) → R given by f (x) = √x for all x ∈ [0, ∞). 3. Let {an}n∈N be a sequence of real numbers. Then we may define a function f : N → R by f (n) = an for all n ∈ N. Definition 1.3. Let X, Y ⊂ R and f : X → Y be a real function. 1. The function f is injective (or one-to-one) if f (a) = f (b) implies a = b for all a, b ∈ X. Equivalently, if a ̸= b, then f (a) ̸= f (b). In this case f is called an injection. 2. The function f is surjective if f (X) = Y . In this case f is called a surjection. 3. The function f is bijective if it is both injective and surjective. In this case f is called a bijection. Example 1.4. For i = 1, 2, 3, let the functions fi have rule fi(x) = x2 for all x ∈ Dom(fi). 1. Let f1 : [0, ∞) → R. Observe that f1 is injective but not surjective. 2. Let f2 : R → [0, ∞). Observe that f2 is surjective but not injective. 3. Let f3 : [0, ∞) → [0, ∞). Observe that f3 is bijective. Definition 1.5. A function f : A → B is said to be invertible if there exists a function g : B → A such that, g ◦ f = idA and f ◦ g = idB. (1) If it exists, such a function g is uniquely determined by f and is called the inverse of f . We use the notation f −1 for the inverse of f . Proposition 1.6. Let f : A → B. Then the function f is invertible if and only if f is bijective. 1.4 Euclidean distance on the real line Definition 1.7. The Euclidean distance on R is the function d : R × R −→ [0, ∞) defined by: d(x, y) = |x − y|, ∀ x, y ∈ R. • For any x, y ∈ R, we call d(x, y) or |x − y| the “distance between x and y\". • We call R with d in Definition 1.7 the “Euclidean space on the real line\". • We will often write | · | meaning the Euclidean distance on the real line. Proposition 1.8. The Euclidean distance on R satisfies the following properties for any x, y, z ∈ R. 1. |x − y| ≥ 0 and |x − y| = 0 if and only if x = y. 2. |x − y| = |y − x| (Symmetry) 4 3. |x − y| ≤ |x − z| + |z − y| (Triangle inequality for real numbers) Remark 1.9. Many of the concepts introduced in the “Real Analysis and the Calculus\" module, such as the notion of convergence of sequences of real num- bers, and, continuity of real functions, are based on the idea of “distance\" be- tween real numbers and the associated idea of “closeness\". 1.5 Inequalities Let us recall how to solve an inequality from the following example. Example 1.10. Assume that we want to solve the inequality x3 ≥ 2x − 1, (2) that is, determine the set of all the x ∈ R that satisfy this inequality. It is convenient to move all terms to the left-hand side, thus obtaining the equivalent inequality x3 − 2x + 1 ≥ 0. It is easily observed that x = 1 is a root of the cubic polynomial in the right-hand side; this can be used to factorise it and rewrite the inequality as (x − 1)(x2 + x − 1) ≥ 0. After a further factorisation we obtain (x − 1)(x − a)(x − b) ≥ 0 where a = −(1 + √5)/2 and b = ( √5 − 1)/2. Since a < b < 1, we can use the following diagram to represent the sign of the factors in the left-hand side, and the corresponding sign of the product. x < a x = a a < x < b x = b b < x < 1 x = 1 1 < x x − a − 0 + + + + + x − b − − − 0 + + + x − 1 − − − − − 0 + x3 − 2x + 1 − 0 + 0 − 0 + From the above diagram, it is clear that x3 − 2x + 1 ≥ 0 if and only if a ≤ x ≤ b or x ≥ 1. In other words, the set of solutions {x ∈ R; x3 ≥ 2x − 1} of the inequality (2) can be written by using the interval notation as [a, b] ∪ [1, ∞). 1.6 Elementary functions and domain convention In mathematics, an elementary function is a function of a single variable (real- valued function of a real variable in this module) that is defined as taking sums, products, dividing, inverses (e.g. arcsin, log, or x1/n), and compositions of finitely many of the following basic functions: • Constant functions: C; 5 • Power functions: xa with a ∈ R; all polynomials can be written as a combination of power functions, p(x) = 5x4 + 2x 3 − 5x 2 + πx − e. • Exponential functions: a x with a > 0; the exponential function ex plays an important (and unique) role in Calculus. • Trigonometric functions: sin x, cos x, tan x, cot x etc. tan x = sin x cos x , cot x = cos x sin x • Hyperbolic functions: sinh x, cosh x, tanh x, coth x etc. sinh x = ex − e−x 2 , cosh x = ex + e−x 2 , similarly for tanh x and coth x. • Inverse functions of the above (if exist), such as logarithms, inverse trigono- metric functions, inverse hyperbolic functions. ln x, loga x, arcsin x, arccos x, arsinh x, · · · Example 1.11. One may check that the inverse function of sinh x is arsinh x = ln(x + √ 1 + x2). Can you graph functions sinh x and arsinh x on [−2, 2]. (You may use https://www.desmos.com/calculator.) Domain Convention: when not otherwise specified, the domain is the largest subset of R for which the given expression makes sense (also called the natural domain). Most functions we have seen are elementary functions. In the following, we give some examples of non-elementary functions Example 1.12. The function s : R → R given by s(x) =    1 if x > 0, 0 if x = 0, −1 if x < 0 (3) is often called the sign function. Another important example is the modulus function, which is the function from R to R that associates to every x ∈ R its modulus (or absolute value) |x|, given by |x| = {x if x ≥ 0, −x if x < 0. It is easy to see that |x| = √x2. Thus, the absolute value function for real variables is also elementary. 6 Example 1.13. The Dirichlet function d : R → R, defined by the following rule: d(x) = { 1 if x ∈ Q, 0 if x /∈ Q, for all x ∈ R. In the course of these lectures we will introduce several properties to rule out such “pathological examples” and consider classes of “well behaved” functions. Example 1.14. One of the most important non-elementary functions is the following error function erf(x) = 2 √π ∫ x 0 e−t2 dt. In this module, we will mainly consider elementary functions, their limits, continuity, and derivatives. 7 2 Limits of functions In this section we will define what we mean by expressions like lim x→x0 f (x) = ℓ which reads “f (x) tends to ℓ as x tends to a”, and illustrate related properties of these limits. 2.1 Limit at a point We start with Definition 2.1. Let f be a real function. Suppose that b < x0 < c and that f is defined on (b, c) \\ {x0}. We say that the limit of f , as x tends to x0, is A if and only if: for any ε > 0, there exists δ > 0, such that |f (x) − A| < ε, whenever 0 < |x − x0| < δ. In this case, we write lim x→x0 f (x) = A . Remark 2.2. 1. lim x→x0 f (x) = A means that as x goes to x0, then |f (x) − A| goes to 0. Alternatively, for any ε > 0, whenever x and x0 are close within a distance of δ, then f (x) and A are close within a distance of ε. For each f , the choice of δ usually depends on ε and x0. 2. The exclusion of x = x0 should be seen as an advantage. An inequality is required to be true for all x satisfying some condition but we don’t need to check x = x0. It may happen to be true that |f (x) − A| < ε when x = x0 but it is irrelevant to Definition 2.1. For instance, in the definition of a derivative of a real function (see Definition 4.2) f ′(x0) = lim x→x0 f (x) − f (x0) x − x0 , we must require that the fraction in the limit is not evaluated at x = x0, to avoid division by 0. We now illustrate how to verify a limit directly from Definition 2.1. Example 2.3. Show that lim x→0 x = 0. Solution: Let ε > 0. We want to show that there exists δ > 0 such that, whenever 0 < |x − 0| < δ, we have |x − 0| < ε. We can take δ = ε (actually any positive δ < ε also works), then it follows |x − 0| < δ = ε provided 0 < |x − 0| < δ. Then by Definition 2.1, lim x→0 x = 0, as required. □ 8 Exercise 2.4. Show that lim x→0 |x| = 0. (Note that ||x| − 0| = |x − 0|.) Example 2.5. Show that lim x→8 2x = 16. Solution: Let ε > 0. We want to show that there exists δ > 0 such that, whenever 0 < |x − 8| < δ, we have |2x − 16| < ε ⇐⇒ |x − 8| < ε 2 . We can take δ = ε 2 . Then by Definition 2.1, lim x→8 2x = 16, as required. □ Example 2.6. Show that lim x→8(10x − 2) = 78. Solution: Let ε > 0. We want to show that there exists δ > 0 such that whenever 0 < |x − 8| < δ, we have |(10x − 2) − 78| < ε ⇐⇒ |x − 8| < ε 10 . Thus, we can take δ = ε 10 (actually any positive δ < ε 10 also works). Then, by Definition 2.1 lim x→8(10x − 2) = 78, as required. □ Observe that Definition 2.1 gives no hints as how to compute limits. It can be used only to verify the correctness of a given limit. We now introduce the squeeze theorem4. Like the squeeze theorem for the limits of sequences, the squeeze theorem for functions will be frequently used. Theorem 2.7 (Squeeze Theorem). Suppose that f , g and h are real functions, and that for some α > 0, f (x) ≤ h(x) ≤ g(x) for all x ∈ (x0 − α, x0 + α) \\ {x0}, and that for some A ∈ R, lim x→x0 f (x) = lim x→x0 g(x) = A. Then lim x→x0 h(x) = A. Proof. Let ε > 0. By Definition 2.1 and lim x→x0 f (x) = A, there exists δ1 > 0 with δ1 < α, such that whenever 0 < |x − x0| < δ1, we have |f (x) − A| < ε ⇐⇒ A − ε < f (x) < A + ε. Similarly, lim x→x0 g(x) = A means that there exists δ2 > 0, with δ2 < α such that whenever 0 < |x − x0| < δ2, we have |g(x) − A| < ε ⇐⇒ A − ε < g(x) < A + ε. Set δ = min{δ1, δ2}. Then whenever 0 < |x − x0| < δ, we have A − ε < f (x) < A + ε A − ε < g(x) < A + ε . 4Also called the sandwich theorem. 9 Figure 1: Diagram illustrating regions which define inequalities used to prove lim x→0 sin x x = 1. Here, B and C are points on the circle with radius 1, centered at A. It follows that whenever 0 < |x − x0| < δ, we have A − ε < f (x) ≤ h(x) ≤ g(x) < A + ε. Therefore by Definition 2.1 we conclude that lim x→x0 h(x) = A, as required. Example 2.8. Show that lim x→0 x2 = 0. Solution: We only need to consider x ∈ (−1, 1), or α = 1 in Theorem 2.7. Then we note that 0 < x 2 < |x| for x ∈ (−1, 1) \\ {0}. Then by Theorem 2.7 and Exercise 2.4, we conclude the proof. □ By using the same argument as above, we can prove lim x→0 x n = 0 for all n ≥ 1. Theorem 2.9. lim x→0 sin x x = 1 . Proof. Consider Figure 1. Let |AB| = |AC| = 1 and ∠CAB = x ∈ (0, π 2 ). Then |CE| = sin x and |DB| = tan x. Therefore: (i) The area of the triangle ABC is sin x 2 . (ii) The area of the segment ABC is x 2 . (iii) The area of the triangle ABD is tan x 2 . 10 From Figure 2.9 and (i)-(iii) above, it follows that sin x 2 < x 2 < tan x 2 , (4) for all x ∈ (0, π 2 ). It follows from (4) that cos x < sin x x < 1, (5) for all x ∈ (0, π 2 ). Since cos x, sin x x and 1 are all even functions of x, the inequalities in (5) are also valid for all x ∈ (− π 2 , 0). We conclude that ∣ ∣ ∣ ∣ sin x x − 1∣ ∣ ∣ ∣ < | cos x − 1| = 1 − cos x = 2 sin2 x 2 ≤ 2 ( x 2 )2 ≤ x2 2 (6) for all 0 < |x| < π 2 . Let ε > 0. Set 0 < δ < min {√2ε, π 2 }. Then it follows from (6) that∣ ∣ sin x x − 1 ∣ ∣ < ε for all x ∈ (−δ, δ) \\ {0}. The result then follows from Definition 2.1, as required. Remark 2.10. Given that lim x→0 ± x2 2 = 0, the final step in the proof of Theorem 2.9 can follow from the Squeeze Theorem, by considering (6) written as − x2 2 < ∣ ∣ ∣ ∣ sin x x − 1 ∣ ∣ ∣ ∣ < x2 2 for all x ∈ (− π 2 , π 2 ) \\ {0}. Remark 2.11. The result in Theorem 2.9, lim x→0 sin x x = 1, is important. From the proof above, we have the following (useful) consequences: (1) | sin x| < |x|, for all x ̸= 0; (2) lim x→0 sin x = 0; (3) lim x→0 cos x = 1; (4) lim x→0 cos x − 1 x = 0. The following example can be used to show that exponential functions are continuous (see for instance, Example 3.6). Example 2.12. Let a > 1, show that lim x→0 a x = 1. Solution: Let ε ∈ (0, 1). Set δ = min{− loga(1 − ε), loga(1 + ε)}. Then, we have x < loga(1 + ε), −x < − loga(1 − ε), for all 0 < |x| < δ. It follows that loga(1 − ε) < x < loga(1 + ε) 11 for all 0 < |x| < δ. Therefore, 1 − ε < a x < 1 + ε, i.e. |a x − 1| < ε for all 0 < |x| < δ. By Definition 2.1 it follows that lim x→0 a x = 1, as required. □ 2.2 One-sided limits and limits as x tends to ∞ Definition 2.13. Suppose that the domain of the real function f contains (a − α, a) for some α > 0 and A ∈ R. If for all ε > 0, there exists δ > 0 with δ < α, such that |f (x) − A| < ε for all a − δ < x < a, then we say the limit of f , as x tends to a from below or the left, is A. In this case we write f (x) → A as x → a −, or lim x→a− f (x) = A. Similarly, we can define lim x→a+ f (x).5 From Definition 2.13, we have Proposition 2.14. Let f be a real function. Then lim x→a f (x) = A if and only if both lim x→a− f (x) and lim x→a+ f (x) exist and lim x→a− f (x) = lim x→a+ f (x) = A . Proof. The proof follows directly from Definitions 2.1 and 2.13. Definition 2.1 allows us to formally describe the limiting behaviour of a function f at a point x0. Similarly, the following definition describes the limiting behaviour of a function f as x gets arbitrarily large. Definition 2.15. Suppose that the domain of a real function f contains (α, ∞) for some α ∈ R and A ∈ R. If for all ε > 0, there exists K > α, such that |f (x) − A| < ε for all x > K, then we say the limit of f , as x tends to ∞, is A. In this case we write f (x) → A as x → ∞, or lim x→∞ f (x) = A. Similarly, we can define lim x→−∞ f (x).6 Remark 2.16. For the one-sided limits, and, for limits as x tends to ±∞, the Squeeze Theorem (Theorem 2.7) holds as well.7 5Write this limit definition yourself as an exercise. 6Write this limit definition yourself as an exercise. 7As an exercise, adapt the proof of Theorem 2.7 yourself to demonstrate that the squeeze theorem holds for left limits. 12 2.3 Non-existence of a limit Similar to sequences, a limit of a function, as x tends to some point, or ±∞, does not necessarily exist. From the definition of a limit, if lim x→x0 f (x) ̸= A, then either the limit lim x→x0 f (x) does not exist, or, the limit exists but is not A. If lim x→x0 f (x) ̸= A then there exists ε0 > 0, such that for any δ > 0 there exists xδ with 0 < |xδ −x0| < δ, for which |f (xδ) − A| > ε0. Example 2.17. Show that lim x→0 sin ( 1 x ) does not exist, but lim x→0 x sin ( 1 x ) exists. sin( 1 x ) x sin( 1 x ) A special case of non-existence of a limit is divergence to ±∞, or it is usually referred as ‘the limit is ±∞’. ‘∞’ is not a number, so if we say that ‘the limit is ∞’, we mean that the limit does not exist. Consequently we have Definition 2.18. Let f be a real function, α > 0 and (x0 − α, x0 + α) \\ {x0} ⊂ Dom(f ). We say that the limit of f as x tends to x0, is ∞ if: for any M > 0, there exists a δ > 0, such that f (x) > M, whenever 0 < |x − x0| < δ. We denote this by lim x→x0 f (x) = ∞ 13 Similarly, one can define lim x→x0 f (x) = −∞. Furthermore, one may define the limit of f to be ±∞, as x → x− 0 , x → x+ 0 , x → ∞, and x → −∞.8 Example 2.19. Prove that lim x→0 1 |x| = ∞. Proof. For any M > 0, set δ = 1 M . We have 1 |x| > 1 δ = M for all x ∈ (−δ, δ) \\ {0}. From Definition 2.18 we conclude that lim x→0 1 |x| = ∞, as required. 2.4 Properties of limits The properties of limits of functions are similar to those of sequences. Here we list them without proofs, which you may find in any standard textbook. Theorem 2.20. Let f and g be real functions. In the following, the abbreviation lim denotes the limit with any one of the following situations: as x → x0, as x → x− 0 , as x → x+ 0 , x → ∞, or as x → −∞. 1. Uniqueness. If lim f (x) = a and lim f (x) = b, then a = b. 2. Squeeze theorem. If f (x) ≤ g(x) ≤ h(x) and both lim f (x) = lim h(x) = ℓ exist, then lim g(x) = ℓ. 3. Boundedness. If lim x→x0 f (x) exists, then there exists δ > 0, such that f is bounded on (x0 − δ, x0) ∪ (x0, x0 + δ). 4. Algebra of limits. Suppose lim f (x) and lim g(x) exist and c ∈ R is a constant. Then: (a) lim cf (x) = c lim f (x). (b) lim(f (x) ± g(x)) = lim f (x) ± lim g(x). (c) lim[f (x)g(x)] = lim f (x) lim g(x). (d) lim f (x) g(x) = lim f (x) lim g(x) , provided g(x) ̸= 0 and lim g(x) ̸= 0. 5. If f (x) ≥ 0 or f (x) > 0, then lim f (x) ≥ 0 if the limit exists. Remark 2.21. For f (x) > 0, one cannot conclude that lim f (x) > 0. For example, f (x) = 1 x > 0 for all x > 0, but lim x→∞ f (x) = 0. We also have some simple facts about limits. 8Ensure that you can adapt the definition of lim x→x0 f = ∞ to these additional cases. 14 Proposition 2.22. Let c ∈ R be a constant, f be a real function such that lim f (x) exists, n ∈ N and a ∈ R. Then: lim[f (x) n] = [lim f (x)] n , lim c = c, lim x→a x = a, lim x→a xn = a n, lim x→a n√x = n√a (for a ≥ 0), lim n√ f (x) = n√lim f (x) (for f ≥ 0). We delay proofs that these limits are valid until Chapter 3 (see Remark 3.3 and Theorem 3.12). We can now use the limits in Proposition 2.22 with Theorem 2.20 to simplify our calculation of limits. Example 2.23. Find lim x→−2 x3 + 2x2 − 1 5 − 3x . Solution: By algebra of limits (quotient rule), we have lim x→−2 x 3 + 2x2 − 1 5 − 3x = lim x→−2 (x3 + 2x2 − 1 ) lim x→−2(5 − 3x) = lim x→−2 x3 + 2 lim x→−2 x2 − lim x→−2 1 lim x→−2 5 − 3 lim x→−2 x = (−2) 3 + 2(−2)2 − 1 5 − 3(−2) = − 1 11 . □ Example 2.24. Find lim x→1 x2 − 1 x − 1 . Solution: We cannot apply the quotient rule in Theorem 2.20 4.(d), since lim x→1(x − 1) = 0. However, we can write x2 − 1 x − 1 = x + 1 , (7) for all x ∈ R \\ {1}. Recall that when considering the limit as x → 1, we don’t need to consider the function when x is equal to 1. It follows from (7) that lim x→1 x2 − 1 x − 1 = lim x→1(x + 1) = 2, as required. □ 15 Example 2.25. Find lim t→0 √t2 + 9 − 3 t2 . Solution: lim t→0 √t2 + 9 − 3 t2 = lim t→0 √t2 + 9 − 3 t2 · √t2 + 9 + 3 √t2 + 9 + 3 = lim t→0 (t2 + 9) − 9 t2( √t2 + 9 + 3) = lim t→0 t 2 t2( √t2 + 9 + 3) = lim t→0 1 √t2 + 9 + 3 = 1 3 + 3 = 1 6 . □ Example 2.26. Find lim x→∞ 3x2 + 2x − 1 x2 − 2 . Solution: Although the function in the limit above is undefined for x = ±√2 this doesn’t affect the limit as x → ∞. For x > 2, we have9 lim x→∞ 3x2 + 2x − 1 x2 − 2 = lim x→∞ 3 + 2 x − 1 x2 1 − 2 x2 = lim x→∞ ( 3 + 2 x − 1 x2 ) lim x→∞ (1 − 2 x2 ) = 3. □ Example 2.27. Given the sequence limit lim n→∞ (1 + 1 n )n = e, where n takes value from integers, prove that lim x→∞ (1 + 1 x )x = e. Here x takes value from real numbers. Proof. For x ≥ 1, we have ( 1 + 1 [x] + 1 )[x] ≤ (1 + 1 x )x ≤ (1 + 1 [x] )[x]+1 , 9In the proof, we make use of the limit lim x→∞ 1 x = 0, which can be verified from Definition 2.15. 16 i.e. ( 1 + 1 [x] + 1 )[x]+1 (1 + 1 [x] + 1 )−1 ≤ (1 + 1 x )x ≤ ( 1 + 1 [x] )[x] ( 1 + 1 [x] ) . Note that [x] ∈ Z +. By using the sequence limit the algebra of limits, and the squeeze theorem, we obtain the result, as required. A fundamental tool used to construct complicated functions out of simple ones is composition. Theorem 2.28. Let f and g be real functions. Suppose that lim y→y0 f (y) = A and lim x→x0 g(x) = y0. Furthermore, suppose there exists δ0 > 0 such that g(x) ̸= y0 for all x ∈ (x0 − δ0, x0 + δ0) \\ {x0}. Then, lim x→x0 f (g(x)) = A. Remark 2.29. The idea of Theorem 2.28 is that g(x) → y0 as x → x0, so in lim x→x0 f (g(x)), we can replace g(x) by y and obtain lim x→x0 f (g(x)) = lim y→y0 f (y). Thus, this theorem also known as \"change of variables\". Remark 2.30. With minor changes, one may replace x0 and y0 in Theorem 2.28 by x± 0 , y± 0 , or ±∞. Example 2.31. Prove that lim x→−∞ ( 1 + 1 x )x = e. Proof. Set y = −(x + 1). Then, as x → −∞, we have y → +∞. Therefore, using Remark 2.30 and Example 2.27, we have lim x→−∞ (1 + 1 x )x = lim y→∞ ( 1 − 1 y + 1 )−(y+1) = lim y→∞ ( y y + 1 )−(y+1) = lim y→∞ ( 1 + 1 y )y+1 = e, as required. Example 2.32. Prove that lim x→0 (1 + x) 1 x = e. Proof. Set y = 1 x . Then, as x → 0 ±, we have y → ±∞. Therefore, via Examples 2.27 and 2.31, we have lim x→0+ (1 + x) 1 x = lim y→∞ (1 + 1 y )y = e, lim x→0− (1 + x) 1 x = lim y→−∞ (1 + 1 y )y = e, as required. 17 Theorem 2.33. Let f be a real function. The following statements are equiv- alent: (a) lim x→x0 f (x) = ℓ; (b) for any sequence {xn} ⊂ Dom(f ) satisfying xn ̸= x0 and xn → x0 as n → ∞, we have lim n→∞ f (xn) = ℓ. Proof. We may view xn as a function over positive integers N. Corollary 2.34. Let f be a real function. Suppose that {xn} ⊂ Dom(f ), xn ̸= x0 for all n ∈ N, xn → x0 as n → ∞ and lim n→∞ f (xn) does not exist. Then lim x→x0 f (x) does not exist. Proof. This follows by the negation of Theorem 2.33. Example 2.35. Show that lim x→0 sin ( 1 x ) does not exist. Solution: Consider the sequence xn := 1 πn+ π 2 for n ∈ N. Observe that lim n→∞ xn = 0. Furthermore, sin ( 1 xn ) = sin ( πn + π 2 ) = (−1) n. Since { sin ( 1 xn )} does not converge, via Corollary 2.34 it follows that lim x→0 sin ( 1 x ) does not exist, as required. □ 18 3 Continuous functions The ‘high-school concept’ of a continuous function is: if you can draw the graph of a function without lifting the pen from the paper, then the function is con- tinuous. This intuition is useful in simple situations, but to consider more interesting/useful situations, we require a rigorous definition. 3.1 Definition of Continuity Definition 3.1. Let f be a real function. Suppose there exists δ > 0 such that (x0 − δ, x0 + δ) is a subset of Dom(f ). We say f is continuous at x0 if lim x→x0 f (x) = f (x0). If f is continuous at all x ∈ Dom(f ), then we say f is a continuous function. Moreover, if lim x→x0 f (x) ̸= f (x0), we say that f is discontinuous at x0. Remark 3.2. Observe that Definition 3.1 implicitly requires three things for f to be continuous at x0: (1) f (x0) is defined (i.e. x0 is in the domain of f ); (2) lim x→x0 f (x) exists; (3) lim x→x0 f (x) = f (x0). Remark 3.3. Let f and g be a real functions. (1) Suppose f is continuous at x0, for x0 ∈ (x − δ, x + δ) ⊂ Dom(f ). Moreover, assume that the sequence {xn} satisfies xn ∈ (x0 −δ, x0 +δ), and, lim n→∞ xn = x0. Then we have lim n→∞ f (xn) = f ( lim n→∞ xn) . By Theorem 2.28, if f is continuous at x0 and lim z→z0 g(z) = x0, then lim z→z0 f (g(z)) = f ( lim z→z0 g(z)) = f (x0). In particular, if f is continuous for all points in Dom(f ), then lim z→z0 f (g(z)) = f ( lim z→z0 g(z) ) . (2) One can define left continuous and right continuous by using one-sided lim- its. For instance, we say f is continuous on a closed interval [a, b], if f is continuous on (a, b) and left continuous and right continuous at b and a, respectively.10 (3) The ε − δ definition of continuity of a function f at x0 is as follows: for any ε > 0, if there exists δ > 0 such that |f (x) − f (x0)| < ε, for all |x − x0| < δ, then f is continuous at x0. 11 10Based on Definition 3.1 you should ensure you can define left-continuous and right- continuous for a real function, yourself. 11Compare this ε − δ definition with Definition 2.1. 19 Example 3.4 (Continuity of constant functions). Let c ∈ R. Prove that f : R → R given by f (x) = c for all x ∈ R, is continuous on R. Proof. For any x0 ∈ R, we have lim x→x0 f (x) = lim x→x0 c = c = f (x0). The conclusion follows from Definition 3.1, as required. By using the facts lim x→0 sin x = 0 and lim x→0 cos x = 1, we now show that both sin x and cos x are continuous at all x ∈ R. Example 3.5 (Continuity of trigonometric functions). Prove that f, g : R → R given by f (x) = sin x and g(x) = cos x for all x ∈ R, are continuous functions on R. Proof. For any x0 ∈ R, via the double angle formula, 12 and the algebra of limits, we have lim x→x0 sin x = lim x→x0 sin(x0 + (x − x0)) = lim x→x0 [ sin x0 cos(x − x0) + cos x0 sin(x − x0)] = sin x0 lim x→x0 cos(x − x0) + cos x0 lim x→x0 sin(x − x0) = sin x0. Since x0 was arbitrary, we conclude that sin x is continuous on R. Similarly, we can show that cos x is continuous on R, as follows: lim x→x0 cos x = lim x→x0 cos(x0 + (x − x0)) = lim x→x0 [ cos x0 cos(x − x0) − sin x0 sin(x − x0) ] = cos x0 lim x→x0 cos(x − x0) + sin x0 lim x→x0 sin(x − x0) = cos x0. Again, since x0 is arbitrary, we conclude that cos x is continuous on R, as required. Example 3.6 (Continuity of exponential functions). Consider f : R → R given by f (x) = a x for all x ∈ R, with a > 0 fixed. Prove that f is continuous on R. Proof. Let x0 ∈ R. For a > 1, we have lim x→x0 a x = a x0 lim x→x0 ax−x0 = a x0 lim y→0 a y = a x0 . For 0 < a < 1, we have 1 a > 1 and lim x→x0 a x = a x0 lim x→x0 a x−x0 = a x0 lim y→0 a y = a x0 1 lim y→0 ( 1 a )y = ax0 . 12The related double angle formula is sin(A + B) = sin(A) cos(B) + cos(A) sin(B). For the continuity result for cos x we use the double angle formula cos(A + B) = cos(A) cos(B) − sin(A) sin(B). 20 On recalling f is a constant function for a = 1, the proof is complete, as required. Example 3.7. Consider f : R → R given by f (x) = |x| for all x ∈ R. Using the ε − δ definition, prove that f is continuous on R. Proof. Let ε > 0 and x0 ∈ R. Set δ = ϵ, and observe that via Proposition 1.8, we have |x| = |(x − x0) + x0| ≤ |x − x0| + |x0| =⇒ |x| − |x0| ≤ |x − x0|, (8) |x0| = |(x0 − x) + x| ≤ |x0 − x| + |x| =⇒ |x| − |x0| ≥ −|x − x0|, (9) for all x ∈ R. It follows from (8) and (9) that |f (x) − f (x0)| = ||x| − |x0|| ≤ |x − x0| < ε for all |x − x0| < δ, as required. 3.2 Continuity of Elementary functions We first recall the convention of elementary functions Definition 3.8 (Elementary Function). An elementary function is a function of one variable which is the composition of a finite number of arithmetic operations (+, −, ×, ÷), exponentials, trigonometries, inverse trigonometries, logarithms, constants, and power functions. In this section, we prove a beautiful result, which says that all elementary functions are continuous (on their domain). To achieve this, we use Theorem 3.9. Theorem 3.9. Let f and g be real functions. (1) If both f (x) and g(x) are continuous at x0, then f (x) ± g(x), f (x)g(x), and f (x) g(x) with g(x0) ̸= 0 are all continuous at x0. (2) If f (y) and g(x) are continuous at g(x0) and x0 respectively, then lim x→x0 f (g(x)) = f (g(x0)), i.e. f (g(x)) is continuous at x0. (3) If f is continuous on [a, b] and f −1 is its inverse, then f −1 is also contin- uous. Example 3.10. Consider g : (0, ∞) → R given by g(x) = ln x for all x ∈ (0, ∞). Prove that g is continuous on (0, ∞). Proof. From Example 3.6, it follows that f : R → (0, ∞) given by f (x) = ex for all x ∈ R is continuous on R. Since f −1(x) = ln x = g(x) for all x > 0, the result follows from Theorem 3.9, as required. 21 Example 3.11 (Continuity of power functions). Let α ∈ R be constant and f : (0, ∞) → R be given by f (x) = xα for all x ∈ (0, ∞). Prove that f is continuous on (0, ∞).13 Proof. Assume that x0 > 0 and α ∈ R. Via Examples 3.6 and 3.10, ex and ln x are continuous functions of x. Therefore, lim x→x0 f (x) = lim x→x0 eln(xα) = lim x→x0 eα ln x = eα lim x→x0 ln x = eα ln x0 = xα 0 = f (x0). Thus, f is continuous on (0, ∞), as required. Note that if α ≥ 0 in Example 3.11 then it follows that xα is also right continuous at x = 0. Theorem 3.12. Elementary functions are continuous (on their domain). Proof. The proof is obtained by collecting proofs we have already seen. For the six types of basic elementary functions, we have: 1. Constant functions: Example 3.4. 2. Trigonometries: Example 3.5 and Theorem 3.9 (1). 3. Inverse trigonometries: Theorem 3.9 (3). 4. Exponentials: Example 3.6. 5. Logarithms: Theorem 3.9 (3). 6. Power functions: Example 3.11. Elementary functions are obtained from the basic elementary functions (in items 1-6 above) with finitely many compositions, inverses, and arithmetic operations. Thus the proof is completed by using Theorem 3.9, as required. Next we state an important limit which is crucial in differential calculus. Theorem 3.13. Prove that lim x→0 ex − 1 x = 1. Proof. Set y = ex for all x ∈ R. Then, as x → 0, we have y → 1 from Example 3.6. Therefore, lim x→0 ex − e0 x = lim x→0 ex − 1 x = lim y→1 y − 1 ln y . (10) Now set z = y − 1. It follows that as y → 1 we have z → 0. Hence lim y→1 y − 1 ln y = lim z→0 z ln(1 + z) = 1 lim z→0 ln(1 + z) 1 z = 1 ln lim z→0(1 + z) 1 z = 1. (11) Note that we have used the continuity of ln x at x = 1, and, Example 2.32, respectively in the second last, and last equalities in (11). The result follows from (10) and (11), as required. 13A related common convention is 00 = 1. We exclude x ≤ 0 though since for some powers α, the domain of xα may be only (0, ∞). For instance, when α = − 1 2 . When the domain of xα is R, continuity of xα can be extended to include (−∞, 0], whilst using the convention above. 22 3.3 Properties of continuous functions on [a, b] Recall that f : [a, b] → R is continuous on a closed interval [a, b], if f is: 1. continuous at every point on (a, b); 2. left continuous at b, i.e. lim x→b− f (x) = f (b); 3. right continuous at a, i.e. lim x→a+ f (x) = f (a). Continuous functions defined on closed and bounded intervals have some useful properties 14. Theorem 3.14 (Boundedness). Let f : [a, b] → R be continuous. Then f is bounded. Theorem 3.15 (Min-max). Let f : [a, b] → R be continuous. Then f achieves it’s minimum and maximum on [a, b]. The following ‘intermediate value theorem’ is one of the cornerstones of analysis. Theorem 3.16. Let f : [a, b] → R be continuous. Suppose that f (a) < 0 and f (b) > 0 15. Then there exists c ∈ (a, b) such that f (c) = 0. An immediate application of Bolzano’s Theorem is what we generally refer to as ‘the intermediate value theorem’. This is stated in Theorem 3.17 (Intermediate value theorem). Let f : [a, b] → R be continuous and satisfy f (a) ̸= f (b). Then for each y ∈ (min{f (a), f (b)}, max{f (a), f (b)}), there exists c ∈ (a, b) such that f (c) = y. Proof. Define g : [a, b] → R to be g(x) = f (x) − y ∀ x ∈ [a, b]. Observe that g is continuous, and either g(a) < 0 < g(b), or, g(a) > 0 > g(b). Thus, it follows from Bolzano’s Theorem that there exists c ∈ (a, b) such that g(c) = 0 ⇐⇒ f (c) = y, which completes the proof, as required. Example 3.18. Let f : R → R be a polynomial of odd degree. Then there exists c ∈ R such that f (c) = 0. Proof. Let the coefficient of the leading term be positive (negative). Then we have lim x→∞ f (x) = ∞(−∞) and lim x→−∞ f (x) = −∞(∞). Therefore, there exists an interval [a, b] where the conditions of Theorem 3.16 are satisfied for f (−f ). The result follows from Theorem 3.16, as required. 14Which you should recall throughout your studies. 15If instead f (a) > 0 and f (b) < 0 we could consider −f to fit the conditions. 23 4 Differentiation 4.1 Introduction We begin with some basic ideas related to the derivative. 4.1.1 Tangent lines Consider a curve C which has equation y = f (x) for some real function f . Suppose that we want to find the tangent line to C at the point P = (a, f (a)). Then we can consider a nearby point Q = (x, f (x)), where x ̸= a, and compute the gradient of the line P Q (see Figure 2): mP Q = f (x) − f (a) x − a . Then we can let Q → P along the curve C by letting x → a. If mP Q → m as Figure 2: The line P Q. x → a then we define the tangent t to be the line through P with gradient m. In summary, the tangent line is the limiting position of the line P Q as Q → P (see Figure 3). Definition 4.1. The tangent line to the curve y = f (x) at the point P = (a, f (a)) is the line through P with gradient m = lim x→a f (x) − f (a) x − a , (12) provided that this limit exists. It is often useful to re-write (12) as m = lim h→0 f (a + h) − f (a) h . 24 Figure 3: The line QP as Q → P . The tangent line is denoted by t. 4.1.2 Velocities Suppose an object moves along a straight line according to an equation of motion s = f (t), where s is the displacement (directed distance) of the object from the origin at time t. The function f that describes the motion is called the position function of the object. In the time interval from t = a to t = a + h, the change in position is f (a + h) − f (a). The average velocity over this time interval is average velocity = displacement time = f (a + h) − f (a) h . Now suppose we compute the average velocities over shorter and shorter time intervals [a, a + h], i.e. we let h approach 0. We define the velocity (or instan- taneous velocity) v(a) at time t = a to be the limit of these average velocities v(a) = lim h→0 f (a + h) − f (a) h . Limits of this form arise whenever we calculate a rate of change in any of the sciences or engineering, such as a rate of a reaction in chemistry or a marginal cost in economics. Since this type of limit occurs so widely, it is given a special name and notation. 4.2 Definition and basic properties Definition 4.2. A real function f : (a, b) → R is differentiable at a point x0 ∈ (a, b) if the limit lim h→0 f (x0 + h) − f (x0) h (13) exists. If this limit exists, it is called the derivative of f at x0, and is denoted by f ′ (x0). 25 Figure 4: Illustrations of ways functions are not differentiable at a. The limit in (13) is equivalent to lim x→x0 f (x) − f (x0) x − x0 . Often we write y = f (x), and then an alternative notation for f ′ (x0) is ( dy dx ) x=x0 or dy dx ∣ ∣ ∣ ∣ x=x0 . We now highlight examples of real functions which are not differentiable. Example 4.3. Let f : R → R be given by f (x) = |x| for all x ∈ R. Show that f is differentiable at all points in R\\{0} and that f is not differentiable at 0. Figure 4 depicts 3 ways that a real function can fail to be differentiable at a point a. The following is an important result which says that differentiability at a point implies continuity at this point. Theorem 4.4. If a real function f is differentiable at x0 ∈ R, then f is con- tinuous at x0. Proof. Since f is differentiable at x0, via Definition 4.2, the limit lim h→0 f (x0 + h) − f (x0) h exists. By the algebra of limits, lim h→0(f (x0 + h) − f (x0)) = lim h→0 ( f (x0 + h) − f (x0) h · h ) = lim h→0 ( f (x0 + h) − f (x0) h ) · ( lim h→0 h ) = f ′(x0) · 0 = 0. (14) 26 It follows from (14) that lim h→0 f (x0 + h) = f (x0) and therefore lim x→x0 f (x) = f (x0) . (15) We conclude from (15) that f is continuous at x0, as required. Corollary 4.5. If a real function f is not continuous at a, then f is not dif- ferentiable at a. Proof. This statement is the contraposition of Theorem 4.4. Remark 4.6. The converse of Theorem 4.4 is not true. Consider f : R → R given by f (x) = |x| for all x ∈ R. Observe that f is continuous on R. However, via Example 4.3 we know that f is not differentiable at 0. 4.3 Differentiation rules So far we have considered the derivative of a real function y = f (x) at a single point. Here we change our perspective and consider the derivative of f : Dom(f ) → R as a function f ′ : Dom(f ′) → R, such that f ′(x) = lim h→0 f (x + h) − f (x) h , for x ∈ Dom(f ) such that the limit exists. Note that Dom(f ′) ⊆ Dom(f ). We can regard f ′ as a new function, called the derivative of f . To denote the derivative of f , we can also write f ′ , df dx , dy dx , d dx f (x) , Df (x) or Df . Definition 4.7. A real function f is differentiable on a set X ⊂ R if it is differentiable at every point in X. From Proposition 4.8 - Theorem 4.18, we establish fundamental rules about differentiation of real functions, which you should know. Proposition 4.8 (Derivative of a Constant Function). Let c ∈ R and f : R → R be given by f (x) = c for all x ∈ R. Then f ′(x) = 0 ∀ x ∈ R. Proof. Observe that f ′(x) = lim h→0 f (x + h) − f (x) h = lim h→0 c − c h = lim h→0 0 = 0 for all x ∈ R, as required. Proposition 4.9 (Derivative of Power Functions). Let n ∈ N and f : R → R be given by f (x) = xn for all x ∈ R. Then f ′(x) = nxn−1 ∀ x ∈ R. (16) 27 Proof. First, if n = 1 then lim h→0 f (x + h) − f (x) h = lim h→0 (x + h) − x h = lim h→0 1 = 1 (17) for all x ∈ R. To establish the result for n ≥ 2 we use the Binomial Theorem lim h→0 f (x + h) − f (x) h = lim h→0 (x + h) n − xn h = lim h→0 n∑ k=0 (n k )xkh n−k − xn h = lim h→0 n−2∑ k=0 ( n k )xkh n−k + nx n−1h + xn − xn h = nxn−1 + lim h→0 n−2∑ k=0 (n k )xkh n−k−1 = nxn−1 (18) for all x ∈ R. The result follows from (17) and (18), as required. The rule in (16) also holds if n ∈ N is replaced by n ∈ R \\ {0} (see Proposition 4.25). We delay the proof of this result until we have established more properties of derivatives (some of which are used in it’s proof). Proposition 4.10 (Linear property). Let λ, µ ∈ R and f, g : X → R be differ- entiable at x ∈ X. Then λf + µg : X → R is differentiable at x, and (λf + µg)′(x) = λf ′(x) + µg′(x). Proof. Since (λf + µg) ′(x) = lim h→0 (λf + µg)(x + h) − (λf + µg)(x) h = lim h→0 λf (x + h) + µg(x + h) − λf (x) − µg(x) h = lim h→0 λf (x + h) − λf (x) h + lim h→0 µg(x + h) − µg(x) h = λ lim h→0 f (x + h) − f (x) h + µ lim h→0 g(x + h) − g(x) h = λf ′(x) + µg′(x) the result follows, as required. It follows immediately from Proposition 4.10 that if f, g : R → R are differ- entiable at x ∈ R, and c ∈ R, then the functions f + g, f − g and cf are differentiable at x ∈ R with derivatives given by f ′(x) + g′(x), f ′(x) − g′(x) and cf ′(x) respectively. 28 Proposition 4.11 (Product Rule). Let f, g : X → R be differentiable at x ∈ X. Then, f g : X → R is differentiable at x and (f g)′(x) = f ′(x)g(x) + f (x)g′(x) . Proof. Observe that (f g) ′(x) = lim h→0 (f g)(x + h) − (f g)(x) h = lim h→0 f (x + h)g(x + h) − f (x)g(x) h = lim h→0 f (x + h)g(x + h) − f (x + h)g(x) + f (x + h)g(x) − f (x)g(x) h = lim h→0 [ f (x + h)g(x + h) − f (x + h)g(x) h + f (x + h)g(x) − f (x)g(x) h ] = lim h→0 [ f (x + h) g(x + h) − g(x) h ] + lim h→0 [ g(x) f (x + h) − f (x) h ] = lim h→0 f (x + h) lim h→0 g(x + h) − g(x) h + g(x) lim h→0 f (x + h) − f (x) h = f (x)g′(x) + g(x)f ′(x) , since via Theorem 4.4, f is continuous at x. This completes the proof, as required. Proposition 4.12 (Quotient Rule). Let f, g : X → R be differentiable at x ∈ X. Then, f /g : Y → R, with Y = {x ∈ X : g(x) ̸= 0} ⊆ X, is differentiable at x if x ∈ Y and, (f /g)′ (x) = f ′(x)g(x) − f (x)g′(x) (g(x))2 . Proposition 4.13 (Differentiation of Trigonometric Functions). Let f, g : R → R be given by f (x) = sin x and g(x) = cos x for all x ∈ R. Then f and g are differentiable on R and, f ′(x) = cos x and g′(x) = − sin x ∀ x ∈ R. Proof. From the trigonometric identity sin(x + h) = cos h sin x + sin h cos x, it folows that sin(x + h) − sin(x) h = cos h sin x + sin h cos x − sin x h = sin h h cos x − (1 − cos h) h sin x = sin h h cos x − (1 − cos 2 h) (1 + cos h)h sin x = sin h h cos x − sin h 1 + cos h sin h h sin x (19) for all x ∈ R. The sine and cosine functions are continuous on R, lim h→0 sin h = 0 and lim h→0 cos h = 1, and via Theorem 2.9, recall that lim h→0 (sin h) h = 1. 29 Thus via the algebra of limits we conclude from (19) that f ′(x) = (sin x) ′ = lim h→0 sin(x + h) − sin(x) h = cos x, for all x ∈ R. This completes the proof of the first identity, as required. The proof of g′(x) = (cos x) ′ = − sin x for all x ∈ R is included in the solutions to the Practice Questions. Corollary 4.14. On their domain of definition, the following derivative for- mulae hold: (tan x)′ = sec 2 x, (cot x)′ = − csc 2 x, (sec x)′ = sec x tan x and (csc x)′ = − csc x cot x. Proof. By writing tan x = sin x cos x , cot x = cos x sin x , sec x = 1 cos x , csc x = 1 sin x and applying the quotient rule with Proposition 4.13, the results follow. Proposition 4.15 (Derivative of ex). Let f : R → R be given by f (x) = ex for all x ∈ R. Then f is differentiable on R, and f ′(x) = ex ∀ x ∈ R. Proof. Via Theorem 3.13, it follows that f ′(x) = lim h→0 ex+h − ex h = ex lim h→0 eh − 1 h = ex for all x ∈ R, as required. Proposition 4.16 (Derivative of ln x). Let f : (0, ∞) → R be given by f (x) = ln x for all x ∈ (0, ∞). Then f is differentiable on (0, ∞) and f ′(x) = 1 x ∀ x ∈ (0, ∞). Proof. Observe that for ln(x + h) − ln x h = ln(1 + h x ) h , (20) for all x ∈ (0, ∞) and h ∈ (−x, ∞) (i.e. so x + h ∈ (0, ∞)). Let ln(1 + h x ) = u. Then, h = x(eu − 1), and u → 0 as h → 0. By Theorems 2.28 and 3.13, via (20) we have f ′(x) = lim h→0 ln(1 + h x ) h = lim u→0 u x(eu − 1) = 1 x for all x ∈ (0, ∞), as required. Corollary 4.17 (Derivative of log x). Let a ∈ (0, ∞) and f : (0, ∞) → R be given by f (x) = loga x for all x ∈ (0, ∞). Then f is differentiable on (0, ∞) and f ′(x) = 1 x ln a ∀ x ∈ (0, ∞). 30 Proof. Since loga x = ln x ln a , the result follows from Propositions 4.16 and 4.10, as required. Now we consider differentiation for composite functions. Recall that g ◦ f is defined by (g ◦ f )(x) = g(f (x)) for all x for which this makes sense. It is initially helpful to establish Theorem 4.18 (Chain Rule). Suppose that f : (a, b) → (c, d) is differentiable at x0 ∈ (a, b) and that g : (c, d) → R is differentiable at f (x0). Then the composed function g ◦ f is differentiable at x0, and (g ◦ f )′(x0) = g′(f (x0))f ′(x0). Thus when x is a variable the chain rule can be written as (g(f (x)))′ = g′(f (x))f ′(x). If y = g(u) and u = f (x), so y = g(f (x)), another way to write the chain rule is dy dx = dy du · du dx . Corollary 4.19. Let n ∈ N and f : R \\ {0} → R be given by f (x) = x−n for all x ∈ R \\ {0}. Then f is differentiable on R \\ {0} and f ′(x) = −nx−(n+1) ∀ x ∈ R \\ {0}. Proof. The result can be obtained by considering g : R \\ {0} → R given by g(x) = x −1 for all x ∈ R \\ {0}, f : R → R given by f (x) = xn for all x ∈ R, Proposition 4.9 and Theorem 4.18. 16 Example 4.20. Calculate the derivatives of the following real functions on their (implied) domains: 1. f (x) = 4x3 − 5x2 + 2x + 1. 2. y = x2 + x − 2 x3 + 6 . 3. y = 1 x . 4. y = x2 sin x. Solution: 1. Recalling Propositions 4.9 and 4.10 it follows that f ′(x) = 12x2 − 10x + 2 ∀ x ∈ R. 2. Recalling Propositions 4.9, 4.10 and 4.12 it follows that dy dx = −x4 − 2x3 + 6x2 + 12x + 6 (x3 + 6)2 ∀ x ∈ R \\ {− 3√6}. 16Complete the details yourself as an exercise. Note that this result can also be obtained directly .. but that doesn’t illustrate Theorem 4.18. 31 3. We can write y = x−1, and use Corollary 4.19 to obtain dy dx = −1x−2 = −1 x2 ∀ x ∈ R \\ {0}. 4. Recalling Propositions 4.11, 4.9 and 4.13, we have y′(x) = 2x sin x + x2 cos x ∀ x ∈ R. □ Example 4.21. Differentiate the following real functions: 1. y = sin(x2); 2. y = sin2 x. Solution: 1. Recalling Theorem 4.18 and Propositions 4.9 and 4.13, we conclude that y′(x) = 2x cos(x2) ∀ x ∈ R. 2. Recalling Propositions 4.11 and 4.13, we conclude that y′(x) = (sin x sin x)′ = 2 sin x cos x ∀ x ∈ R. □ Example 4.22. Calculate f ′(x) for f (x) = (2x + 1)5(x3 − 2x + 3)3 ∀ x ∈ R. Solution: Recalling Theorem 4.18 and Propositions 4.9, 4.10 and 4.11, it follows that f ′(x) = 10(2x + 1) 4(x3 − 2x + 3) 3 + 3(2x + 1) 5(x3 − 2x + 3) 2(3x2 − 2) ∀ x ∈ R. □ Example 4.23. Differentiate the real function y = sin(cos(tan x)) ∀ x ∈ (− π 2 , π 2 ) . Solution: Recalling Theorem 4.18, Proposition 4.13 and Corollary 4.14, it fol- lows that y′(x) = − cos(cos(tan x)) sin(tan x) sec 2 x ∀ x ∈ (− π 2 , π 2 ) . □ Example 4.24. Let a ∈ (0, ∞) and f : R → R be given by f (x) = a x for all x ∈ R. Find f ′(x). 32 Solution: Write f (x) = a x = e x ln a ∀ x ∈ R. (21) It follows from Theorem 4.18, (21) and Propositions 4.15 and 4.10 that f ′(x) = (ex ln a)′ = ex ln a(x ln a) ′ = ex ln a ln a = a x ln a for all x ∈ R, as required. □ Using the same idea as in Example 21 we establish an extension of Proposi- tion 4.9 in Proposition 4.25 (Derivative of Power Functions). Let α ∈ R \\ {0} and f : (0, ∞) → R be given by f (x) = xα for all x ∈ (0, ∞). Then f ′(x) = αx α−1 ∀ x ∈ (0, ∞). Proof. Write f (x) = xα = eα ln x ∀ x ∈ (0, ∞). (22) It follows from Theorem 4.18, (22) and Propositions 4.15, 4.16 and 4.10, that f ′(x) = d dx eα ln x = eα ln x (α ln x)′ = eα ln x α x = αx α−1 for all x ∈ (0, ∞), as required. Note that the result in Proposition 22 can be extended to more x ∈ R provided that xα is actually defined and differentiable. 17 4.4 Derivatives of Inverse Functions To study the differentiation of inverse functions, we state Theorem 4.26. Suppose that f satisfies the conditions of the Inverse Function Theorem. Moreover, let x0 ∈ (a, b), y0 = f (x0) and f be differentiable at x0 with f ′(x0) ̸= 0. Then f −1 is differentiable at y0, and (f −1) ′(y0) = 1 f ′(x0) . Note that we may also write (f −1)′(y0) = 1 f ′(f −1(y0)) . An easy way to remember this is to write y = f (x), and then x = f −1(y), so (f −1)′(y) = dx dy = ( dy dx )−1 = 1 f ′(x) . 17I.e. be careful when α ∈ (−∞, 1) and if x ≤ 0. 33 Example 4.27 (Differentiation of inverse trigonometric functions). Recall that the function sin : [ − π 2 , π 2 ] → [−1, 1] is differentiable and increasing at every point in (− π 2 , π 2 ). The inverse function arcsin is a such that arcsin : [−1, 1] → [− π 2 , π 2 ]. Write f (x) = sin(x) and g(y) = arcsin(y), and, let x ∈ [− π 2 , π 2 ] and y = f (x). Then y ∈ (−1, 1) if and only if x ∈ (− π 2 , π 2 ). For such y, by Theorem 4.26, g is differentiable at y, and g′(y) = 1 f ′(x) = 1 cos(x) = 1 √1 − sin2(x) = 1 √1 − y2 . (23) Note that in (23) we take the positive square root because cos x > 0 when x ∈ (− π 2 , π 2 ). Therefore, d dy (arcsin y) = 1 √1 − y2 ∀ y ∈ (−1, 1). The function tan : (− π 2 , π 2 ) → (−∞, ∞) is increasing and differentiable at every point in (− π 2 , π 2 ). We can define the inverse function arctan as a well- defined continuous function such that arctan : (−∞, ∞) → (− π 2 , π 2 ). Write y = f (x) = tan(x) and x = g(y) = arctan(y), and let x ∈ (− π 2 , π 2 ). Then via Theorem 4.26, g is differentiable at y, and g′(y) = 1 f ′(x) = 1 sec2 x = 1 1 + tan2 x = 1 1 + y2 . So, d dy (arctan y) = 1 1 + y2 ∀ y ∈ (−∞, ∞). Similarly, by writing arccos x = π 2 − arcsin x and arccotx = π 2 − arctan x it follows that d dx arccos x = −1 √1 − x2 and d dx arccotx = −1 1 + x2 . We summarize the differentiation formulas in this section and the previous section, as follows (with the domain convention applying): (λf + µg)′ = λf ′ + µg′ λ, µ are constants (f g)′ = f ′g + f g′ ( f g )′ = f ′g − f g′ g2 [f (g(x))] ′ = f ′(g(x))g′(x) . d dx (c) = 0 , c is a constant d dx (xα) = αx α−1 , α ∈ R \\ {0} is a constant 34 d dx (ex) = ex , d dx (ln x) = 1 x , d dx (sin x) = cos x , d dx (tan x) = sec2 x , d dx (sec x) = sec x tan x , d dx (arcsin x) = 1 √1 − x2 , d dx (arctan x) = 1 1 + x2 , d dx (ax) = a x ln a , d dx (loga x) = 1 x ln a , d dx (cos x) = − sin x , d dx (cot x) = − csc 2 x , d dx (csc x) = − csc x cot x , d dx (arccos x) = −1 √1 − x2 , d dx (arccotx) = −1 1 + x2 . 4.5 Implicit differentiation and logarithmic differentiation The functions we have seen so far can be described by expressing one variable explicitly in terms of another variable. For example: 1. y = √x3 + 1, 2. y = x sin x. or, in general, y = f (x). Some functions, however, are defined implicitly by a relation between x and y, such as: 1. x2 + y2 = 25, 2. x3 + y3 = 6xy. In some cases it is possible to solve such an equation for y as an explicit function (or several functions) of x. For instance, if we solve x2 + y2 = 25 for y, we get y = ± √25 − x2, so two of the functions determined by the implicit equation are f1(x) = √25 − x2 and f2(x) = −√25 − x2. The graphs of f1 and f2 are the upper and lower semicircles of the circle x2 + y2 = 25. It’s not easy to solve x3 + y3 = 6xy for y explicitly as a function of x, by hand. A computer algebra system18 has no trouble, but the expressions it obtains are very complicated. Nonetheless, the solutions to this equation yield a curve called the folium of Descartes, which is illustrated in Figure 5. When we say that f is a function defined implicitly by x3 + y3 = 6xy, we mean that the equation x3 + (f (x))3 = 6xf (x) is true for all values of x in the domain of f . Fortunately, we don’t need to solve an equation for y in terms of x in order to find the derivative of y. Instead we can use the method of implicit differen- tiation. This consists of differentiating both sides of an equation with respect to x and then solving the resulting equation for y′. In the examples in this section it is always assumed that the given equation determines y implicitly as 18Such as Maple in this case. 35 Figure 5: Folium of Descartes. a differentiable function of x so that the method of implicit differentiation can be applied. Example 4.28. Find y′ if x3 + y3 = 6xy. Moreover, find the tangent to the folium of Descartes x3 + y3 = 6xy at the point (3, 3). Solution: We differentiate both sides of x3 + y3 = 6xy with respect to x, con- sidering y to be a function of x (i.e. y(x)). Using the chain rule on y3, and the product rule on 6xy, we obtain 3x 2 + 3y2y′ = 6xy′ + 6y =⇒ x2 + y2y′ = 2xy′ + 2y . We now solve for y′, to find that y2y′ − 2xy′ = 2y − x2 (y2 − 2x) y′ = 2y − x2 y′ = 2y − x2 y2 − 2x . (24) To find the tangent at (x, y) = (3, 3), substitution of (x, y) = (3, 3) into (24) yields y′ = −1. So the tangent to the folium at (3, 3) can be expressed as y − 3 = −(x − 3), as required. □ Example 4.29. Find y′ if sin(x + y) = y2 cos x. (25) Solution: Differentiating both sides of (25) implicitly with respect to x, while recalling y is a function of x, we conclude that cos(x + y) · (1 + y′) = y2(− sin x) + (cos x) (2yy′) . (26) Solving for y′ in (26) gives y′ = y2 sin x + cos(x + y) 2y cos x − cos(x + y) , 36 as required. □ The calculation of derivatives of complicated functions involving products, quotients, or powers can often be simplified by taking logarithms. The method used in the following example is called logarithmic differentiation. Example 4.30. Differentiate the following equation with respect to x, y = x3/4√x2 + 1 (3x + 2)5 . (27) Solution: We take logarithms of both sides of (27) and use the properties of logarithms to conclude that ln y = 3 4 ln x + 1 2 ln(x2 + 1) − 5 ln(3x + 2). (28) Differentiating both sides of (28) implicitly with respect to x gives 1 y y′ = 3 4 · 1 x + 1 2 · 2x x2 + 1 − 5 · 3 3x + 2 . (29) Solving for y′ in (29), recalling (27), gives y′ = y ( 3 4x + x x2 + 1 − 15 3x + 2 ) = x3/4√x2 + 1 (3x + 2)5 ( 3 4x + x x2 + 1 − 15 3x + 2 ) , as required. □ Example 4.31. Differentiate y = x√x . (30) Solution: Note that the real function y(x) in (30) is well-defined for x > 0. Since both the base and the exponent are variables, we use logarithmic differentiation. From (30), taking logarithms, gives ln y = ln x√x = √x ln x. (31) Implicit differentiation of (31) gives y′ y = √x · 1 x + (ln x) 1 2 √x , which via (30) implies y′ = y ( 1 √x + ln x 2√x ) = x √x ( 2 + ln x 2√x ) , as required. Note that another way to answer this question would be to write y = e √x ln x and apply the chain rule. □ 37 5 Applications of differentiation In this section, we will cover many of the major applications of derivatives. Applications included are the mean value theorem, L’Hospital’s Rule, Taylor’s theorem, determining the absolute and relative minimum and maximum func- tion values, and sketching the graph of a function without using a computational aid. 5.1 Rolle’s theorem and mean value theorems One of the most important results in the theory of real functions is Rolle’s Theorem and its consequence, the Mean Value theorem. It underpins a lot of what we know about functions. Theorem 5.1 (Rolle’s Theorem). Suppose that f : [a, b] → R is continuous on [a, b], differentiable on (a, b), and f (a) = f (b). Then there exists c ∈ (a, b) such that f ′(c) = 0. Theorem 5.2 (Mean Value Theorem). Suppose that f : [a, b] → R is continuous on [a, b] and differentiable on (a, b). Then there exists c ∈ (a, b) such that f (b) − f (a) b − a = f ′(c). (32) Corollary 5.3. Suppose that f : [a, b] → R is continuous on [a, b] and differen- tiable on (a, b). (1) If f ′(x) = 0 for all x ∈ (a, b), then f is constant on [a, b]. (2) If f ′(x) > 0 for all x ∈ (a, b), then f is strictly increasing on [a, b]. (3) If f ′(x) < 0 for all x ∈ (a, b), then f is strictly decreasing on [a, b]. We will not discuss the detailed proofs for Theorem 5.1, 5.2, and Corollary 5.3. They will be covered in a second-year module “Real and Complex Analysis\". Remark 5.4. The converse of parts (2) and (3) of Corollary 5.3 are not true. For instance, suppose that f : R → R is given by f (x) = x3 for all x ∈ R. Then f is strictly increasing on R, but f ′(0) = 0. However, it can be shown that if a real function f is increasing and differentiable, then f ′ ≥ 0. Example 5.5. Show that, if − π 4 ≤ a < b ≤ π 4 , then | tan b − tan a| < 2|b − a|. (33) Solution: The function f : (− π 2 , π 2 ) → R given by f (x) = tan x for all x ∈ (− π 2 , π 2 ) is continuous and differentiable. Hence f is continuous on [a, b] and differentiable on (a, b), because (a, b) ⊂ [a, b] ⊂ (− π 2 , π 2 ). Hence by the Mean Value Theorem, there exists c ∈ (a, b) such that tan b − tan a b − a = sec 2 c. (34) From (34) it follows that | tan b − tan a| = (sec 2 c)|b − a| ∀ − π 2 < a < b < π 2 . (35) 38 Since cos 2 x > 1 2 for all x ∈ (− π 4 , π 4 ), it follows from (35) that | tan b − tan a| < 2|b − a|, as required. □ The Mean Value Theorem is very useful for proving inequalities of the type in (33) i.e. inequalities of the form |f (x) − f (y)| ≤ c|x − y| with constant c. We now consider a useful generalization of the Mean Value Theorem, known as the Generalized Mean Value Theorem, or Cauchy’s Mean Value19 Theorem. Theorem 5.6 (Generalized Mean Value Theorem). Suppose that f, g : [a, b] → R are continuous on [a, b], differentiable on (a, b), and that g′(x) ̸= 0 for all x ∈ (a, b). Then there exists c ∈ (a, b) such that f (b) − f (a) g(b) − g(a) = f ′(c) g′(c) . (36) 5.2 L’Hospital’s rule Our main application of the Generalized Mean Value Theorem is L’Hospital’s Rule. L’Hospital’s Rule is mostly used to calculate limits of the form lim x→x0 f (x) g(x) such that lim x→x0 f (x) = lim x→x0 g(x) = 0. This indeterminate form of limit is called the “ 0 0 ” form. Corollary 5.7 (L’Hospital’s Rule). Let I ⊂ R be an open interval and x0 ∈ I. Suppose that f, g : I → R are differentiable on I \\{x0} and g′(x) ̸= 0 on I \\{x0}. Moreover, suppose that lim x→x0 f (x) = lim x→x0 g(x) = 0 (37) or that lim x→x0 f (x) = ±∞ and lim x→x0 g(x) = ±∞. (38) (In other words, we have an indeterminate form of type “ 0 0 ” or “ ± ∞ ∞ ”.) Then lim x→x0 f (x) g(x) = lim x→x0 f ′(x) g′(x) if the limit on the right side exists, is −∞ or is ∞. Remark 5.8. 1. The “ 0 0 ” and “ ∞ ∞ ” are called indeterminate forms. L’Hospital’s Rule only works for indeterminate forms. For example, consider lim x→1 2x − 1 x = lim x→1 (2x − 1) lim x→1 x = 1. 19Cauchy is one of the most widely known mathematicians in history, in particular, in relation to the devepment of real and complex analysis. See [1] for historical details, if you are interested. 39 However, if we take the derivative of the top and bottom, we get lim x→1 (2x − 1)′ (x)′ = lim x→1 2 1 = 2. Thus the conclusion of L’Hospital’s rule doesn’t hold for the above deter- minate form. 2. L’Hospital’s Rule is also valid for one-sided limits and for limits at infinity or negative infinity; that is, “x → x0” can be replaced by any of the symbols “x → x+ 0 ”, “x → x − 0 ”, “x → ∞”, or “x → −∞”. Example 5.9. Find lim x→0 1 − cos x x2 . Solution: The functions f, g : R → R given by f (x) = 1 − cos x and g(x) = x2 for all ∈ R are differentiable on R. Moreover, lim x→0 f (x) = lim x→0 g(x) = 0 and g′(x) ̸= 0 whenever x ̸= 0. Hence, by L’Hospital’s Rule ( 0 0 form), we have lim x→0 1 − cos x x2 = lim x→0 (1 − cos x)′ (x2)′ = lim x→0 sin x 2x = 1 2 . □ Example 5.10. Find lim x→∞ ex x2 Solution: The functions f, g1, g2 : R → R given by f (x) = ex, g1(x) = x2 and g2(x) = g′ 1(x) for all x ∈ R are differentiable on R. Moreover, lim x→∞ f (x) = lim x→∞ gi(x) = ∞ and g′ i(x) ̸= 0 whenever x > 0 (i = 1, 2). Hence, by L’Hospital’s Rule ( ∞ ∞ form), we have, lim x→∞ ex x2 = lim x→∞ ex 2x = lim x→∞ ex 2 = ∞. In other words, the limit does not exist. Generally, for any polynomial P : R → R of degree n, by using L’Hospital’s rule n times, we see that lim x→∞ ex |P (x)| = ∞. This shows that when x becomes large, the exponential function f (or f (x) = a x with a > 1 for all x ∈ R) grows much faster than any polynomial P : R → R. □ Example 5.11. Evaluate lim x→0+ x ln x . This is called an indeterminate form of “0 · ∞′′ type. Solution: The functions f, g : (0, ∞) → R given by f (x) = ln x and g(x) = 1 x for all x ∈ (0, ∞) are differentiable on (0, ∞). Moreover, lim x→0+ f (x) = lim x→0+ g(x) = 40 ±∞ and g′(x) ̸= 0 for all x ∈ (0, ∞). Hence, by L’Hospital’s Rule ( ∞ ∞ form), we have lim x→0+ x ln x = lim x→0+ ln x 1 x = lim x→0+ 1 x − 1 x2 = lim x→0+ −x = 0 . Note that 0 · ∞ forms can generally be converted into 0 0 or ∞ ∞ forms using the idea illustrated above. □ Example 5.12. Find lim x→ π 2 −(sec x − tan x) This is called indeterminate form of “∞ − ∞′′ type. Solution: We first convert the expression into the form f (x) g(x) so L’Hospital’s rule can be used i.e. (sec x − tan x) = 1 − sin x cos x . The functions f, g : R → R given by f (x) = 1 − sin x and g(x) = cos x for all x ∈ R are differentiable on R. Moreover, lim x→ π 2 − f (x) = lim x→ π 2 − g(x) = 0 and g′(x) ̸= 0 for all x ∈ (0, π 2 ). Hence, by L’Hospital’s Rule ( 0 0 form), we have lim x→ π 2 −(sec x − tan x) = lim x→ π 2 − 1 − sin x cos x = lim x→ π 2 − − cos x − sin x = 0 . □ We omit some details in the remaining examples in this section, for brevity. Example 5.13 (Exponential trick). Calculate lim x→0+(1 + sin(4x))cot x . This is called indeterminate form of “1∞” type. Solution: We don’t yet know if the limit is finite, but formally, we have lim x→0+(1 + sin(4x))cot x = lim x→0+ ecot x ln(1+sin(4x)) = e limx→0+ cot x ln(1+sin(4x)). (39) The exponent is (almost) in the 0 0 form of L’Hospital’s rule and hence, lim x→0+ cot x ln(1+sin(4x)) = lim x→0+ cos x lim x→0+ ln(1 + sin(4x)) sin x = lim x→0+ 4cos(4x) 1+sin(4x) cos x = 4. (40) Therefore, via (39) and (40), it follows that lim x→0+(1 + sin(4x))cot x = e4. Note that since ex is continuous on R, and, the limit in (40) is finite, the formal step in (39) is made rigorous, on recalling Remark 3.3. □ Example 5.14. Find lim x→∞ x 1 x and lim x→0+ xx . The first indeterminate form is of “∞0” type whereas the second indeterminate form is of “00” type. 41 Solution: We first use the ‘exponential trick’, then interchange the limits since ex is continuous, and then use L’Hospital’s rule in the ∞ ∞ form, i.e. lim x→∞ x 1 x = lim x→∞ e ln x x = elimx→∞ ln x x = elimx→∞ 1 x 1 = 1. Similarly 20 lim x→0+ xx = 1 . □ 5.3 Higher derivatives and Taylor’s theorem We can use polynomials to approximate the real function to get better and better approximations. These polynomials are known as Taylor polynomials. To proceed, we introduce the notion of higher derivatives. Definition 5.15. Suppose that f is differentiable with derivative f ′ on an interval, and that f ′ is itself differentiable. Then we denote the derivative of f ′ by f ′′, and call it the second derivative of f . Continuing in this way (differentiability permitting), we obtain functions f, f ′, f ′′, f ′′′, . . . , f (n) each of which is the derivative of the function before. We call f (n) the n-th derivative of f . If f (n) exists for all positive integers n, then we say that f is infinitely differentiable. If y = f (x), some other notation for the n-th derivatives of f (x) are d ny dxn , d nf dxn , d nf (x) dxn and dnf dxn (x) . Note that dyn dxn does not make sense. The reason is that, we treat differentiation d dx as an operator, and apply this operator to f (x) n times. Suppose that f and all its derivatives exist on (a, b), and that x0 ∈ (a, b). By Taylor’s Theorem, for all t such that x0 + t ∈ (a, b) and all n ∈ N, we can write f (x0 + t) = n∑ k=0 f (k)(x0) k! tk + Rn(t), (41) where Rn(t) = f (n+1)(x0 + θt) (n + 1)! tn+1 (42) for some θ(t) ∈ (0, 1). If Rn(t) → 0 as n → ∞ for all t such that x0 + t ∈ (a, b), then the series ∞∑ k=0 f (k)(x0) k! tk 20Complete the details yourself as an exercise. 42 converges, to f (x0 + t). This series is called the Taylor Series of f centred at x0. Sometimes we set x = x0 + t, and write f (x) = ∞∑ k=0 f (k)(x0) k! (x − x0)k. In this case, the restriction x0 + t ∈ (a, b) becomes x ∈ (a, b). Remark 5.16. Taylor Series centred at 0 (that is, series for which the centre x0 is 0) are usually known as Maclaurin Series, for historical reasons. Example 5.17. Find the Maclaurin Series of the function f : R → R given by f (x) = sin x for all x ∈ R. Solution: We observe that f is infinitely differentiable on R, and f (x) = sin(x) f ′(x) = cos(x) f ′′(x) = − sin(x) f ′′′(x) = − cos(x) f (4)(x) = sin(x) = f (x) (43) and so, the derivatvives repeat periodically. Setting x = 0 in (43) implies that f (n)(0) = { 0 if n = 2k, k = 0, 1, 2 . . . (−1) k if n = 2k + 1, k = 0, 1, 2 . . .. Now, taking the centre x0 to be 0 and fixing t, from (42) it follows that |Rn(t)| = ∣ ∣ ∣ ∣ tn+1 (n + 1)! ∣ ∣ ∣ ∣ ∣ ∣ ∣f (n+1)(θt)∣ ∣ ∣ ≤ |t|n+1 (n + 1)! , since | sin(θt)| ≤ 1 and | cos(θt)| ≤ 1 for all t ∈ R and θ ∈ (0, 1). Therefore, since |t| n+1 (n + 1)! → 0 as n → ∞ it follows from the Sandwich Theorem (Theorem 2.7) for any fixed t ∈ R, that Rn(t) → 0 as n → ∞. Therefore, sin(t) = f (t) = ∞∑ k=0 (−1)kt 2k+1 (2k + 1)! = t − t3 3! + t 5 5! − t7 7! + . . . is the Maclaurin series of the sine function, which is valid for all t ∈ R. □ 5.4 Maximum and Minimum values Let us recall the definition of the maximum and minimum values of a real function f . Definition 5.18. Let c ∈ Dom(f ) for a real function f . Then f (c) is the: 43 • absolute maximum value of f on Dom(f ) if f (c) ≥ f (x) for all x ∈ Dom(f ). • absolute minimum value of f on Dom(f ) if f (c) ≤ f (x) for all x ∈ Dom(f ). Absolute maximum/minimum are sometimes alternatively called global maxi- mum/minimum. The maximum and minimum values of f are called extreme values of f . Definition 5.19. Let c ∈ Dom(f ) for a real function f . Then f (c) is the: • local maximum value of f if f (c) ≥ f (x) for all x close to c (i.e. there exists δ > 0 such that f (c) ≥ f (x) for all x ∈ (c − δ, c + δ) ∩ Dom(f )). • local minimum value of f if f (c) ≤ f (x) for all x close to c (i.e. there exists δ > 0 such that f (c) ≤ f (x) for all x ∈ (c − δ, c + δ) ∩ Dom(f )). Figure 6: In the above graph, f (a) is the absolute minimum, f (d) is the absolute maximum, f (e) and f (c) are the local minima, and, f (b) and f (d) are the local maxima. We next state the Fermat’s theorem. The proof is similar to that of Rolle’s theorem and is omitted, for brevity. Theorem 5.20 (Fermat’s Theorem). Let I ⊆ R be an open interval. Suppose that f : I → R has a local maximum or minimum at c ∈ I, and that f ′(c) exists. Then f ′(c) = 0. To complement Fermat’s Theorem, we have Definition 5.21. Let I ⊂ R and suppose that f : I → R. The point c is called a stationary point of f if f ′(c) = 0. The following examples warn us against solely using Fermat’s Theorem to locate maxima and minima of continuous real functions. Specifically, we can’t expect to locate extreme values simply by setting f ′(x) = 0 and solving for x (since inflection points exist, and, not every function is differentiable). 44 Example 5.22. Let f : R → R be given by f (x) = x3 for all x ∈ R. Then f ′(x) = 3x2 for all x ∈ R, so f ′(0) = 0. However, f has no maximum or minimum at x = 0. Example 5.23. Let f : R → R be given by f (x) = |x| for all x ∈ R. Then f has its (local and absolute) minimum value at x = 0, but that value can’t be found by setting f ′(x) = 0 because f ′(0) does not exist. Example 5.24. Let f : [−1, 1] → R be given by f (x) = x for all x ∈ [−1, 1]. Then f has its (local and absolute) minimum value at x = −1, and it’s (local and absolute) maximum at x = 1, but these value can’t be found by setting f ′(x) = 0 because f ′(x) = 1 for all x ∈ [−1, 1]. Examples 5.22, 5.23 and 5.24 show that we must be careful when using Fermat’s Theorem. Example 5.22 shows that even when f ′(c) = 0 there need not be a maximum or minimum at c (i.e. we can also have inflection points, see Definition 5.35). Example 5.22 shows that maxima/minima for f can occur at points where f ′ does not exist. Example 5.24 shows that maximum/minima can occur at endpoints of an interval where a continuous function is defined. 21 Fermat’s Theorem does suggest that we should at least start looking for extreme values of continuous real functions f at the numbers c where f ′(c) = 0 or where f ′(c) does not exist. Such numbers are given a special name. Definition 5.25. A critical number of a function f is a number c in the domain of f such that either f ′(c) = 0 or f ′(c) does not exist. Example 5.26. Find the critical numbers of f : [0, ∞) → R which is given by f (x) = x 3 5 (4 − x) ∀ x ∈ [0, ∞). Solution: Observe that f ′(x) = 12 − 8x 5x 2 5 ∀ x ∈ (0, ∞), (44) and lim h→0+ f (h) − f (0) h = ∞. (45) Via (44) f ′(x) = 0 iff x = 3 2 . Also via (44) and (45) f ′(x) does not exist iff x = 0. Thus the critical numbers of f (x) are 3 2 and 0. □ In terms of critical numbers, Fermat’s Theorem can be rephrased as follows Proposition 5.27. Let I ⊆ R be an open interval. Let f : I → R have a local maximum or minimum at c ∈ I. Then c is a critical number of f . To find an absolute maximum or minimum of a continuous function on a closed interval, we note that either it is local maximum or minimum, or it occurs at an endpoint of the interval. Thus the following procedure is used to find maximum and minima of continuous functions f : [a, b] → R. (1) Find the values of f at the critical numbers of f in (a, b). 21For a function f : [a, b] → R which is differentiable, think about the conditions on f ′(a) and f ′(b) which are necessary for a maxima/minima to occur at a or b. 45 (2) Find the values of f at the endpoints of the interval i.e. find f (a) and f (b). (3) The largest of the values from Steps (1) and (2) is the absolute maximum value, and, the smallest of these values is the absolute minimum value. Example 5.28. Find the absolute maximum and absolute minimum values of the function f : [− 1 2 , 4] → R given by f (x) = x 3 − 3x2 + 1 ∀ x ∈ [ − 1 2 , 4 ] . Solution: We use the aforementioned procedure. (1) Since f ′(x) = 3x2 − 6x = 3x(x − 2) ∀ x ∈ [ − 1 2 , 4 ] , (46) it follows that f ′(x) exists for all x ∈ (− 1 2 , 4 ). The only critical numbers of f occur when f ′(x) = 0, that is via (46), at x = 0 and x = 2. Notice that each of these critical numbers lies in the interval (− 1 2 , 4). The values of f at it’s critical numbers are f (0) = 1 and f (2) = −3. (47) (2) The values of f at the endpoints of the interval are f (− 1 2 ) = 1 8 and f (4) = 17. (48) (3) By comparing these four numbers in (47) and (48), we see that the absolute maximum value of f is f (4) = 17 and the absolute minimum value of f is f (2) = −3. □ The following result characterizes the absolute minimum/maximum in simpler situations. Proposition 5.29 (First Derivative Test for Absolute Extreme Values). Let I ⊆ R be an open interval. Suppose that c ∈ I is a critical number of a continuous function f : I → R. (a) If f ′(x) > 0 for all x < c and f ′(x) < 0 for all x > c, then f (c) is the absolute maximum value of f . (b) If f ′(x) < 0 for all x < c and f ′(x) > 0 for all x > c, then f (c) is the absolute minimum value of f . Proof. The proof is intuitive since, for example the conditions in case (a) imply that f (x) is strictly increasing when x < c and strictly decreasing when x > c. It immediately follows that f (c) is the absolute maximum. Case (b) is proved similarly. We also have a local version of the First Derivative Test. Proposition 5.30 (First Derivative Test for Local Extreme Values). Let I ⊆ R be an open interval. Suppose that c ∈ I is a critical number of a continuous function f : I → R. 46 (a) Suppose that f ′ changes from positive to negative at c, as x increases. Then f has a local maximum at c. (b) Suppose that f ′ changes from negative to positive at c, as x increases. Then f has a local minimum at c. (c) Suppose that f ′ is positive to the left and right of c, or negative to the left and right of c. Then f has no local maximum or minimum at c. For clarification in Proposition 5.30, if f ′ changes from positive to negative at c as x increases, this means that there is a δ > 0 such that f ′(x) > 0 for x ∈ (c − δ, c) and f ′(x) < 0 for x ∈ (c, c + δ). We omit the proof of Proposition 5.30 since it is essentially the same as that of Proposition 5.29. The following Second Derivative Test identifies the local maximum and min- imum of a function, when, the function is sufficiently smooth. Theorem 5.31. Let I ⊆ R be an open interval and f : I → R. Suppose that f ′′ is continuous on I and c ∈ I. 1. Suppose that f ′(c) = 0 and f ′′(c) > 0. Then f has a local minimum at c. 2. Suppose that f ′(c) = 0 and f ′′(c) < 0. Then f has a local maximum at c. Example 5.32. Consider f, g : R → R given by f (x) = x2 and g(x) = −x2 for all x ∈ R. Demonstrate that the minimum and maximum of f and g respectively agree with Theorem 5.31. Solution: Since f ′(x) = 2x and f ′′(x) = 2 ∀ x ∈ R, g′(x) = −2x and g′′(x) = −2 ∀ x ∈ R, it follows that x = 0 is the unique critical point of f and g i.e. f ′(0) = g′(0) = 0. It follows that 0 is the absolute minimum and absolute maximum of f and g respectively. Moreover, the signs of the second derivatives of f and g agree with Theorem 5.31. □ 5.5 Curve Sketching 5.5.1 Asymptotes Definition 5.33. The line y = L is called a horizontal asymptote of the curve y = f (x) if either lim x→∞ f (x) = L or lim x→−∞ f (x) = L . The line x = a is a vertical asymptote if at least one of the following statements is true: lim x→a+ f (x) = ∞, lim x→a+ f (x) = −∞, lim x→a− f (x) = ∞, lim x→a− f (x) = −∞. 47 Figure 7: Horizontal and vertical asymptotes for the function y = √2x2+1 3x−5 . Some curves have asymptotes that are oblique, that is, neither horizontal nor vertical. If lim x→∞(f (x) − (mx + b)) = 0 or lim x→−∞ (f (x) − (mx + b)) = 0 , where m ̸= 0, then the line y = mx + b is called an oblique asymptote. This is because the vertical distance between the curve y = f (x) and the line y = mx+b approaches 0 in the limit. A function with an oblique asymptote is illustrated in Figure 8. Figure 8: Depiction of an oblique asymptote. For rational functions, oblique asymptotes occur when the degree of the polynomial in the numerator is 1 more than the degree of the polynomial in the denominator. 22 22Define a simple example of a rational function with an oblique asymptote yourself. 48 5.5.2 Concavity The two graphs in Figure 9 show two increasing functions on (a, b). Both graphs join point A to point B but they look different because they bend in different directions. How can we distinguish between these two types of behavior? Figure 9: Two curves connecting A and B with differing curvatures. Definition 5.34. If the graph of f lies above all of its tangents on an interval I, then it is called concave upward on I. If the graph of f lies below all of its tangents on I, it is called concave downward on I. According to Definition 5.34, Figure 9 (a) is concave upward on (a, b) while Figure 9 (b) is concave downward on (a, b). To test if a function is concave on an interval we can use the following test: (1) If f ′′(x) > 0 for all x in I, then the graph of f is concave upward on I. (2) If f ′′(x) < 0 for all x in I, then the graph of f is concave downward on I. Definition 5.35. A point P on a curve y = f (x) is called an inflection point if f is continuous there and the curve changes from concave upward to concave downward or from concave downward to concave upward at P . We conclude with some guidelines for what to depict when sketching curves y = f (x): (A) Domain + axis + curve labels. (B) x and y intercepts - i.e. intersection points between the curve and the axes, found from f (0) and f (x) = 0. (You can omit this step if equations are difficult to solve). (C) Symmetry - Whether f is even, odd or periodic. (D) Asymptotes - horizontal, vertical and oblique asymptotes. (E) Intervals of Increase or Decrease. (F) Local Maximum and Minimum Values. (G) Concavity and Points of Inflection. 49 (H) An actual sketch of the Curve. Example 5.36. Sketch the graph of f : R → R given by f (x) = x3 x2 + 1 ∀ x ∈ R. Solution: The domain is R. The x and y intercepts (of the axes) are 0. f is odd, so the graph is anti-symmetric about the the line x = 0. The denominator x2 + 1 is never 0 so there is no vertical asymptote. lim x→∞ f (x) = ∞, so there is no horizontal asymptote. We see that f (x) = x3 x2 + 1 = x − x x2 + 1 ∀ x ∈ R. This equation suggests that y = x is a candidate for an oblique asymptote. In fact, f (x) − x → 0 as x → ±∞. Thus, y = x is an oblique asymptote for f (x) as x → ±∞. The derivative of f is given by f ′(x) = x2(x2 + 3) (x2 + 1)2 ∀ x ∈ R. Since f ′(x) > 0 for all x ∈ R \\ {0}, it follows that f (x) is increasing on R. Although f ′(0) = 0, f ′ does not change sign at 0, so there is no local maximum or minimum. The second derivative of f is given by f ′′(x) = 2x(3 − x2) (x2 + 1)3 ∀ x ∈ R. Since f ′′(x) = 0 when x = 0 or x = ±√3 , we setup the following chart: interval f ′′ f x < −√3 + CU on (−∞, −√3) − √3 < x < 0 − CD on (−√3, 0) 0 < x < √3 + CU on (0, √3) x > √3 − CD on (√3, ∞) The points of inflection are (−√3, − 3√3 4 ), (0, 0) and (√3, 3√3 4 ). The graph sketch is depicted in Figure 10. □ References [1] J. J. O’Connor and E. F. Robertson, Augustin Louis Cauchy, MacTutor, https://mathshistory.st-andrews.ac.uk/Biographies/Cauchy/ [2] W. Rudin, Principles of Mathematical Analysis. Ed. 3, McGraw Hill, USA, 1976. [3] A. E. Taylor. L’Hospital’s rule. The American Mathematical Monthly, 59(1):20–24, 1952 DOI:10.1080/00029890.1952.11988058. 50 Figure 10: Sketch of f (x) = x3 x2+1 . 51","libVersion":"0.3.2","langs":""}